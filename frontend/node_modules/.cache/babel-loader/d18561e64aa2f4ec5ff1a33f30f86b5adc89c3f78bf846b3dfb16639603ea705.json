{"ast":null,"code":"var _jsxFileName = \"/Users/tommys/Desktop/ai14/frontend/src/components/Dashboard/PromptWorkshop.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback, useRef } from 'react';\nimport { DndContext, DragOverlay, closestCenter, PointerSensor, KeyboardSensor, useSensor, useSensors, MeasuringStrategy } from '@dnd-kit/core';\nimport { SortableContext, arrayMove, verticalListSortingStrategy, sortableKeyboardCoordinates } from '@dnd-kit/sortable';\nimport { v4 as uuidv4 } from 'uuid';\nimport BlockPalette from './BlockPalette';\nimport PromptBuilder from './PromptBuilder/PromptBuilder';\nimport SortableBlock from './PromptBuilder/SortableBlock';\nimport Sandbox from './Sandbox';\nimport Modal from '../common/Modal';\nimport MaterialListForModal from './MaterialListForModal';\nimport PromptListForModal from './PromptListForModal';\nimport { getMaterials, getTeacherPrompts, savePrompt, updatePrompt, getPromptDetails } from '../../services/api';\nimport { FaSave, FaEdit, FaFileUpload, FaHistory, FaQuestion, FaSyncAlt, FaSpinner } from 'react-icons/fa';\nimport '../../styles/PromptWorkshop.css';\n\n// Block Types Definition (καμία αλλαγή)\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport const BlockTypes = {\n  PALETTE_ITEM: 'palette-item',\n  CANVAS_BLOCK: 'canvas-block',\n  MATERIAL_SUMMARY: 'material-summary',\n  CUSTOM_TEXT: 'custom-text'\n};\n\n// Μεταφρασμένα και βελτιωμένα μπλοκ οδηγιών (unchanged)\nconst initialPreMadeBlocks = {\n  '🎯 Βασικός Ρόλος & Προσωπικότητα': [{\n    id: 'core-task-1',\n    type: BlockTypes.PALETTE_ITEM,\n    title: 'Κύριος Ρόλος',\n    content: 'Λειτούργησε ως ένας εξυπηρετικός ψηφιακός βοηθός διδασκαλίας για μαθητές [Τάξη/Επίπεδο], με ειδίκευση στο μάθημα [Μάθημα/Θέμα].'\n  }, {\n    id: 'persona-expert-1',\n    type: BlockTypes.PALETTE_ITEM,\n    title: 'Προσωπικότητα Ειδικού',\n    content: 'Υιοθέτησε την προσωπικότητα ενός ειδικού με γνώσεις και μεταδοτικότητα στο αντικείμενο [Μάθημα/Θέμα]. Εξήγησε τις έννοιες με σαφήνεια.'\n  }, {\n    id: 'persona-mentor-1',\n    type: BlockTypes.PALETTE_ITEM,\n    title: 'Προσωπικότητα Μέντορα',\n    content: 'Υιοθέτησε την προσωπικότητα ενός υποστηρικτικού μέντορα, καθοδηγώντας τους μαθητές στο μαθησιακό τους ταξίδι.'\n  }],\n  '🗣️ Ύφος & Τόνος': [{\n    id: 'tone-friendly-1',\n    type: BlockTypes.PALETTE_ITEM,\n    title: 'Φιλικό & Ενθαρρυντικό Ύφος',\n    content: 'Διατήρησε έναν φιλικό, υπομονετικό και ενθαρρυντικό τόνο σε όλη τη συζήτηση. Χρησιμοποίησε θετική ενίσχυση.'\n  }, {\n    id: 'tone-formal-1',\n    type: BlockTypes.PALETTE_ITEM,\n    title: 'Επίσημο & Ακαδημαϊκό Ύφος',\n    content: 'Υιοθέτησε ένα επίσημο, αντικειμενικό και ακαδημαϊκό ύφος, κατάλληλο για μελέτη.'\n  }, {\n    id: 'style-concise-1',\n    type: BlockTypes.PALETTE_ITEM,\n    title: 'Συνοπτικές Απαντήσεις',\n    content: 'Κράτα τις εξηγήσεις σου σαφείς, περιεκτικές και όσο το δυνατόν πιο σύντομες, χωρίς να χάνεται το νόημα.'\n  }, {\n    id: 'style-detailed-1',\n    type: BlockTypes.PALETTE_ITEM,\n    title: 'Αναλυτικές Εξηγήσεις',\n    content: 'Παρείχε αναλυτικές εξηγήσεις, προσφέροντας υπόβαθρο, παραδείγματα και αναλογίες όπου είναι χρήσιμο.'\n  }],\n  '📚 Πλαίσιο & Γνώση': [{\n    id: 'ctx-material-1',\n    type: BlockTypes.PALETTE_ITEM,\n    title: 'Χρήση ΜΟΝΟ του Υλικού',\n    content: 'Βάσισε αυστηρά τις απαντήσεις και τις εξηγήσεις σου στο διδακτικό υλικό που παρέχεται. Εάν μια πληροφορία δεν υπάρχει, δήλωσέ το ξεκάθαρα και μην επινοείς απαντήσεις.'\n  }, {\n    id: 'ctx-refer-material-1',\n    type: BlockTypes.PALETTE_ITEM,\n    title: 'Αναφορά σε Συγκεκριμένο Υλικό',\n    content: 'Όταν απαντάς, να αναφέρεσαι ρητά σε συγκεκριμένες ενότητες ή ιδέες από το [Όνομα Μπλοκ Υλικού], εάν είναι σχετικό.'\n  }],\n  '💡 Διδακτικές Στρατηγικές': [{\n    id: 'strat-socratic-1',\n    type: BlockTypes.PALETTE_ITEM,\n    title: 'Σωκρατική Μέθοδος',\n    content: 'Αντί να δίνεις άμεσες απαντήσεις, καθοδήγησε τους μαθητές κάνοντας μια σειρά από διερευνητικές ερωτήσεις για να τους βοηθήσεις να φτάσουν στη λύση μόνοι τους.'\n  }, {\n    id: 'strat-stepbystep-1',\n    type: BlockTypes.PALETTE_ITEM,\n    title: 'Ανάλυση Βήμα-Βήμα',\n    content: 'Για σύνθετα προβλήματα ή διαδικασίες, ανάλυσέ τα σε μικρότερα, λογικά και εύκολα βήματα. Εξήγησε κάθε βήμα με σαφήνεια.'\n  }, {\n    id: 'strat-analogy-1',\n    type: BlockTypes.PALETTE_ITEM,\n    title: 'Χρήση Αναλογιών',\n    content: 'Χρησιμοποίησε σχετικές αναλογίες και παραδείγματα από την καθημερινή ζωή για να κάνεις τις αφηρημένες έννοιες πιο κατανοητές.'\n  }],\n  '✅ Παραδείγματα & Υποστήριξη': [{\n    id: 'ex-positive-1',\n    type: BlockTypes.PALETTE_ITEM,\n    title: 'Παράδειγμα Διαλόγου',\n    content: 'Παράδειγμα Ερώτησης Μαθητή: [Απλή Ερώτηση]\\nΠαράδειγμα Σωστής Απάντησης Βοηθού: [Σαφής, βοηθητική, καθοδηγητική απάντηση βασισμένη στην προσωπικότητα/ύφος σου]'\n  }, {\n    id: 'scaffold-hints-1',\n    type: BlockTypes.PALETTE_ITEM,\n    title: 'Παροχή Υποδείξεων',\n    content: 'Εάν ένας μαθητής έχει κολλήσει, πρόσφερε μια μικρή υπόδειξη ή μια υπενθύμιση μιας σχετικής έννοιας πριν δώσεις πιο άμεση βοήθεια.'\n  }],\n  '🛡️ Ασφάλεια & Δεοντολογία': [{\n    id: 'safe-offtopic-1',\n    type: BlockTypes.PALETTE_ITEM,\n    title: 'Άρνηση Άσχετων Ερωτήσεων',\n    content: 'Αρνήσου ευγενικά να απαντήσεις σε ερωτήσεις που είναι άσχετες με το μάθημα, ακατάλληλες, επιβλαβείς, ανήθικες ή ζητούν προσωπικές πληροφορίες.'\n  }, {\n    id: 'safe-no-pii-1',\n    type: BlockTypes.PALETTE_ITEM,\n    title: 'Όχι Προσωπικά Δεδομένα',\n    content: 'Μην ζητάς, αποθηκεύεις ή μοιράζεσαι ποτέ προσωπικά δεδομένα (ΠΔ) από ή για τον μαθητή ή άλλους.'\n  }]\n};\n\n// Μεταφρασμένα βήματα περιήγησης (unchanged copy/text)\nconst guidedSteps = [{\n  selector: '.workshop-column.palette',\n  content: '1. Βιβλιοθήκη Μπλοκ: Εδώ βρίσκονται έτοιμες παιδαγωγικές οδηγίες. Κάντε κλικ σε μία για να την προσθέσετε στον καμβά.'\n}, {\n  selector: '.workshop-column.canvas',\n  content: '2. Καμβάς Οδηγιών: Συνθέστε τις οδηγίες του βοηθού εδώ. Σύρετε τα μπλοκ για να αλλάξετε τη σειρά τους.'\n}, {\n  selector: '.prompt-metadata-controls',\n  content: '3. Λεπτομέρειες & Ενέργειες: Δώστε όνομα, περιγραφή και ορατότητα στον βοηθό σας. Από εδώ μπορείτε να αποθηκεύσετε, να φορτώσετε ή να προσθέσετε υλικό.'\n}, {\n  selector: '.workshop-column.sandbox',\n  content: '4. Περιοχή Δοκιμών: Δοκιμάστε τον βοηθό σας σε πραγματικό χρόνο! Γράψτε μια ερώτηση μαθητή για να δείτε πώς απαντά.'\n}];\nfunction PromptWorkshop() {\n  _s();\n  const [materials, setMaterials] = useState([]);\n  const [savedPrompts, setSavedPrompts] = useState([]);\n  const [currentPrompt, setCurrentPrompt] = useState({\n    id: null,\n    name: '',\n    description: '',\n    is_public: false,\n    structure: [],\n    system_prompt: ''\n  });\n  const [activeId, setActiveId] = useState(null);\n  const [loadingState, setLoadingState] = useState({\n    materials: true,\n    prompts: true,\n    promptDetails: false\n  });\n  const [isSaving, setIsSaving] = useState(false);\n  const [messages, setMessages] = useState({\n    error: '',\n    success: ''\n  });\n  const [showLoadPromptModal, setShowLoadPromptModal] = useState(false);\n  const [showAddMaterialModal, setShowAddMaterialModal] = useState(false);\n\n  // --- Quick Tour state (enhanced) ---\n  const [isTutorialActive, setIsTutorialActive] = useState(false);\n  const [tutorialStep, setTutorialStep] = useState(0);\n  const highlightedElementRef = useRef(null);\n  const tooltipRef = useRef(null);\n  const [tooltipPos, setTooltipPos] = useState({\n    top: 24,\n    left: 24,\n    placement: 'right'\n  });\n  const [focusables, setFocusables] = useState([]);\n  const sensors = useSensors(useSensor(PointerSensor, {\n    activationConstraint: {\n      distance: 8\n    }\n  }), useSensor(KeyboardSensor, {\n    coordinateGetter: sortableKeyboardCoordinates\n  }));\n  const clearMessages = useCallback(() => setMessages({\n    error: '',\n    success: ''\n  }), []);\n  const showSuccess = useCallback((msg, dur = 3500) => {\n    setMessages({\n      error: '',\n      success: msg\n    });\n    setTimeout(clearMessages, dur);\n  }, [clearMessages]);\n  const showError = useCallback(msg => {\n    setMessages({\n      error: msg,\n      success: ''\n    });\n  }, []);\n  const fetchAllMaterials = useCallback(async () => {\n    setLoadingState(s => ({\n      ...s,\n      materials: true\n    }));\n    try {\n      const r = await getMaterials();\n      setMaterials(r.data || []);\n    } catch (e) {\n      console.error(\"Error fetching materials:\", e);\n      showError(\"Αδυναμία φόρτωσης υλικών.\");\n      setMaterials([]);\n    } finally {\n      setLoadingState(s => ({\n        ...s,\n        materials: false\n      }));\n    }\n  }, [showError]);\n  const fetchAllPrompts = useCallback(async () => {\n    setLoadingState(s => ({\n      ...s,\n      prompts: true\n    }));\n    try {\n      const r = await getTeacherPrompts();\n      setSavedPrompts(r.data || []);\n    } catch (e) {\n      console.error(\"Error fetching prompts:\", e);\n      showError(\"Αδυναμία φόρτωσης αποθηκευμένων βοηθών.\");\n      setSavedPrompts([]);\n    } finally {\n      setLoadingState(s => ({\n        ...s,\n        prompts: false\n      }));\n    }\n  }, [showError]);\n  useEffect(() => {\n    fetchAllMaterials();\n    fetchAllPrompts();\n  }, [fetchAllMaterials, fetchAllPrompts]);\n  const handleAddBlock = useCallback(blockFromPalette => {\n    clearMessages();\n    const newBlock = {\n      id: `canvas-${uuidv4()}`,\n      type: BlockTypes.CANVAS_BLOCK,\n      title: blockFromPalette.title,\n      content: blockFromPalette.content\n    };\n    setCurrentPrompt(p => ({\n      ...p,\n      structure: [...p.structure, newBlock]\n    }));\n  }, [clearMessages]);\n  const handleAddMaterialSummary = useCallback(material => {\n    clearMessages();\n    if (!(material !== null && material !== void 0 && material.id)) {\n      showError(\"Επιλέχθηκε μη έγκυρο υλικό.\");\n      return;\n    }\n    const summaryBlock = {\n      id: `mat-${material.id}-${uuidv4()}`,\n      type: BlockTypes.MATERIAL_SUMMARY,\n      title: `📄 Πλαίσιο από: ${material.name}`,\n      content: `[USE_FULL_TEXT_FROM_MATERIAL_ID:${material.id}] Πληροφορίες από το υλικό με τίτλο \"${material.name}\".`,\n      isMaterialBlock: true,\n      materialId: material.id,\n      materialName: material.name\n    };\n    setCurrentPrompt(prev => ({\n      ...prev,\n      structure: [...prev.structure, summaryBlock]\n    }));\n    showSuccess(`Προστέθηκε το πλαίσιο από \"${material.name}\" (το AI θα χρησιμοποιήσει το πλήρες κείμενο).`);\n    setShowAddMaterialModal(false);\n  }, [clearMessages, showError, showSuccess]);\n  const handleAddCustomTextBlock = useCallback(() => {\n    clearMessages();\n    const nb = {\n      id: `custom-${uuidv4()}`,\n      type: BlockTypes.CUSTOM_TEXT,\n      title: '✏️ Προσαρμοσμένη Οδηγία',\n      content: 'Εισαγάγετε τη δική σας οδηγία...'\n    };\n    setCurrentPrompt(p => ({\n      ...p,\n      structure: [...p.structure, nb]\n    }));\n  }, [clearMessages]);\n  const handleDeleteBlock = useCallback(id => {\n    clearMessages();\n    setCurrentPrompt(p => ({\n      ...p,\n      structure: p.structure.filter(b => b.id !== id)\n    }));\n  }, [clearMessages]);\n  const handleUpdateBlockContent = useCallback((id, content) => {\n    clearMessages();\n    setCurrentPrompt(p => ({\n      ...p,\n      structure: p.structure.map(b => b.id === id ? {\n        ...b,\n        content\n      } : b)\n    }));\n  }, [clearMessages]);\n  const handlePromptNameChange = e => setCurrentPrompt(p => ({\n    ...p,\n    name: e.target.value\n  }));\n  const handlePromptDescriptionChange = e => setCurrentPrompt(p => ({\n    ...p,\n    description: e.target.value\n  }));\n  const handlePromptPublicToggle = e => setCurrentPrompt(p => ({\n    ...p,\n    is_public: e.target.checked\n  }));\n  const handleSavePrompt = useCallback(async () => {\n    clearMessages();\n    if (!currentPrompt.name.trim()) {\n      showError(\"Το όνομα του βοηθού AI είναι απαραίτητο.\");\n      return;\n    }\n    setIsSaving(true);\n    const payload = {\n      name: currentPrompt.name.trim(),\n      description: currentPrompt.description.trim(),\n      is_public: currentPrompt.is_public,\n      structure: currentPrompt.structure\n    };\n    try {\n      let response;\n      let msg = '';\n      if (currentPrompt.id) {\n        response = await updatePrompt(currentPrompt.id, payload);\n        msg = `Ο βοηθός \"${response.data.name}\" ενημερώθηκε επιτυχώς.`;\n        setSavedPrompts(prev => prev.map(p => p.id === response.data.id ? {\n          ...p,\n          ...response.data\n        } : p));\n        const updatedDetails = await getPromptDetails(currentPrompt.id);\n        setCurrentPrompt(prev => ({\n          ...prev,\n          ...updatedDetails.data\n        }));\n      } else {\n        response = await savePrompt(payload);\n        msg = `Ο βοηθός \"${response.data.name}\" δημιουργήθηκε επιτυχώς.`;\n        setCurrentPrompt(prev => ({\n          ...prev,\n          id: response.data.id,\n          ...response.data,\n          system_prompt: response.data.system_prompt\n        }));\n        setSavedPrompts(prev => [response.data, ...prev]);\n      }\n      showSuccess(msg);\n    } catch (err) {\n      var _err$response, _err$response$data;\n      console.error(\"Error saving prompt:\", err);\n      showError(((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.error) || \"Αποτυχία αποθήκευσης του βοηθού AI.\");\n    } finally {\n      setIsSaving(false);\n    }\n  }, [currentPrompt, showError, showSuccess, clearMessages]);\n  const handleLoadPrompt = useCallback(async promptToLoad => {\n    clearMessages();\n    if (!(promptToLoad !== null && promptToLoad !== void 0 && promptToLoad.id)) {\n      showError(\"Επιλέχθηκε μη έγκυρος βοηθός.\");\n      setShowLoadPromptModal(false);\n      return;\n    }\n    setLoadingState(s => ({\n      ...s,\n      promptDetails: true\n    }));\n    try {\n      const response = await getPromptDetails(promptToLoad.id);\n      const fp = response.data;\n      setCurrentPrompt({\n        id: fp.id,\n        name: fp.name || '',\n        description: fp.description || '',\n        is_public: !!fp.is_public,\n        structure: Array.isArray(fp.structure) ? fp.structure : [],\n        system_prompt: fp.system_prompt || ''\n      });\n      showSuccess(`Φορτώθηκε ο βοηθός: \"${fp.name}\"`);\n    } catch (err) {\n      console.error(\"Error loading prompt details:\", err);\n      showError(`Αποτυχία φόρτωσης του \"${promptToLoad.name}\".`);\n    } finally {\n      setLoadingState(s => ({\n        ...s,\n        promptDetails: false\n      }));\n      setShowLoadPromptModal(false);\n    }\n  }, [showError, showSuccess, clearMessages]);\n  const handleNewPrompt = useCallback(() => {\n    clearMessages();\n    setCurrentPrompt({\n      id: null,\n      name: '',\n      description: '',\n      is_public: false,\n      structure: [],\n      system_prompt: ''\n    });\n    showSuccess(\"Ο καμβάς είναι έτοιμος για ένα νέο βοηθό.\");\n  }, [clearMessages, showSuccess]);\n  const handleDragStart = event => {\n    clearMessages();\n    setActiveId(event.active.id);\n  };\n  const handleDragEnd = event => {\n    const {\n      active,\n      over\n    } = event;\n    setActiveId(null);\n    if (over && active.id !== over.id) {\n      const oldIdx = currentPrompt.structure.findIndex(i => i.id === active.id);\n      const newIdx = currentPrompt.structure.findIndex(i => i.id === over.id);\n      if (oldIdx !== -1 && newIdx !== -1) {\n        setCurrentPrompt(p => ({\n          ...p,\n          structure: arrayMove(p.structure, oldIdx, newIdx)\n        }));\n      }\n    }\n  };\n  const draggedBlockData = activeId ? currentPrompt.structure.find(b => b.id === activeId) : null;\n  const systemPromptForSandbox = currentPrompt.system_prompt ? currentPrompt.system_prompt : currentPrompt.structure.map(block => block.content).join(\"\\n\\n\");\n\n  // -----------------------------\n  // Quick Tour: helpers & effects\n  // -----------------------------\n  const startTutorial = () => {\n    setIsTutorialActive(true);\n    setTutorialStep(0);\n  };\n  const nextTutorialStep = () => {\n    if (tutorialStep < guidedSteps.length - 1) setTutorialStep(s => s + 1);else setIsTutorialActive(false);\n  };\n  const prevTutorialStep = () => {\n    if (tutorialStep > 0) setTutorialStep(s => s - 1);\n  };\n  const endTutorial = useCallback(() => {\n    if (highlightedElementRef.current) {\n      highlightedElementRef.current.classList.remove('tutorial-highlight');\n      highlightedElementRef.current = null;\n    }\n    setIsTutorialActive(false);\n  }, []);\n\n  // Smart tooltip positioning near the highlighted element\n  const positionTooltipFor = useCallback(element => {\n    if (!element) return;\n    const rect = element.getBoundingClientRect();\n    const tW = tooltipRef.current && tooltipRef.current.offsetWidth || 360;\n    const tH = tooltipRef.current && tooltipRef.current.offsetHeight || 180;\n    const gap = 12;\n    const pad = 12;\n\n    // prefer right -> left -> bottom -> top\n    let left = rect.right + gap;\n    let top = rect.top + rect.height / 2 - tH / 2;\n    let placement = 'right';\n    const fitsRight = left + tW + pad <= window.innerWidth;\n    const fitsLeft = rect.left - gap - tW - pad >= 0;\n    const fitsBottom = rect.bottom + gap + tH + pad <= window.innerHeight;\n    const fitsTop = rect.top - gap - tH - pad >= 0;\n    if (!fitsRight) {\n      if (fitsLeft) {\n        left = rect.left - gap - tW;\n        top = rect.top + rect.height / 2 - tH / 2;\n        placement = 'left';\n      } else if (fitsBottom) {\n        left = rect.left + rect.width / 2 - tW / 2;\n        top = rect.bottom + gap;\n        placement = 'bottom';\n      } else {\n        left = rect.left + rect.width / 2 - tW / 2;\n        top = rect.top - gap - tH;\n        placement = 'top';\n      }\n    }\n\n    // clamp into viewport\n    left = Math.max(pad, Math.min(left, window.innerWidth - tW - pad));\n    top = Math.max(pad, Math.min(top, window.innerHeight - tH - pad));\n    setTooltipPos({\n      left,\n      top,\n      placement\n    });\n  }, []);\n\n  // Reposition + highlight per step\n  useEffect(() => {\n    if (!isTutorialActive) return;\n\n    // lock scroll while touring\n    const prevOverflow = document.body.style.overflow;\n    document.body.style.overflow = 'hidden';\n\n    // remove previous highlight\n    if (highlightedElementRef.current) {\n      highlightedElementRef.current.classList.remove('tutorial-highlight');\n      highlightedElementRef.current = null;\n    }\n    const step = guidedSteps[tutorialStep];\n    let element = null;\n    try {\n      element = step && step.selector ? document.querySelector(step.selector) : null;\n    } catch {\n      element = null;\n    }\n    if (element) {\n      element.scrollIntoView({\n        behavior: 'smooth',\n        block: 'center',\n        inline: 'nearest'\n      });\n      // adjust for sticky header\n      setTimeout(() => {\n        try {\n          window.scrollBy({\n            top: -80,\n            left: 0,\n            behavior: 'auto'\n          });\n        } catch {}\n      }, 220);\n      element.classList.add('tutorial-highlight');\n      highlightedElementRef.current = element;\n\n      // position the tooltip after it renders, then set focusables\n      setTimeout(() => {\n        positionTooltipFor(element);\n        if (!tooltipRef.current) return;\n        const selector = ['button', '[href]', 'input', 'select', 'textarea', '[tabindex]:not([tabindex=\"-1\"])'].join(',');\n        const nodes = Array.from(tooltipRef.current.querySelectorAll(selector)).filter(el => !el.hasAttribute('disabled') && !el.getAttribute('aria-hidden'));\n        setFocusables(nodes);\n        const primary = tooltipRef.current.querySelector('.button.primary-button');\n        (primary || nodes[0]) && (primary || nodes[0]).focus();\n      }, 0);\n    } else {\n      // center tooltip if element missing\n      setTooltipPos({\n        top: window.innerHeight / 2 - 120,\n        left: window.innerWidth / 2 - 200,\n        placement: 'bottom'\n      });\n      setTimeout(() => {\n        if (!tooltipRef.current) return;\n        const selector = ['button', '[href]', 'input', 'select', 'textarea', '[tabindex]:not([tabindex=\"-1\"])'].join(',');\n        const nodes = Array.from(tooltipRef.current.querySelectorAll(selector)).filter(el => !el.hasAttribute('disabled') && !el.getAttribute('aria-hidden'));\n        setFocusables(nodes);\n        const primary = tooltipRef.current.querySelector('.button.primary-button');\n        (primary || nodes[0]) && (primary || nodes[0]).focus();\n      }, 0);\n    }\n    const handleResize = () => {\n      if (highlightedElementRef.current) positionTooltipFor(highlightedElementRef.current);\n    };\n    const handleScroll = () => {\n      if (highlightedElementRef.current) positionTooltipFor(highlightedElementRef.current);\n    };\n    const handleKey = e => {\n      if (!isTutorialActive) return;\n      if (e.key === 'Escape') {\n        e.preventDefault();\n        endTutorial();\n        return;\n      }\n      if (e.key === 'ArrowRight' || e.key === 'Enter') {\n        e.preventDefault();\n        nextTutorialStep();\n        return;\n      }\n      if (e.key === 'ArrowLeft') {\n        e.preventDefault();\n        prevTutorialStep();\n        return;\n      }\n\n      // focus trap\n      if (e.key === 'Tab' && focusables.length) {\n        const first = focusables[0];\n        const last = focusables[focusables.length - 1];\n        if (e.shiftKey && document.activeElement === first) {\n          e.preventDefault();\n          last.focus();\n        } else if (!e.shiftKey && document.activeElement === last) {\n          e.preventDefault();\n          first.focus();\n        }\n      }\n    };\n    window.addEventListener('resize', handleResize, {\n      passive: true\n    });\n    window.addEventListener('scroll', handleScroll, {\n      passive: true\n    });\n    window.addEventListener('keydown', handleKey);\n    return () => {\n      window.removeEventListener('resize', handleResize);\n      window.removeEventListener('scroll', handleScroll);\n      window.removeEventListener('keydown', handleKey);\n      document.body.style.overflow = prevOverflow;\n    };\n  }, [isTutorialActive, tutorialStep, positionTooltipFor, endTutorial, focusables.length]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"prompt-workshop-page page-content-wrapper\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"page-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: [/*#__PURE__*/_jsxDEV(FaEdit, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 425,\n          columnNumber: 21\n        }, this), \" \\u0395\\u03C1\\u03B3\\u03B1\\u03C3\\u03C4\\u03AE\\u03C1\\u03B9\\u03BF \\u0392\\u03BF\\u03B7\\u03B8\\u03CE\\u03BD AI\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 425,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: startTutorial,\n        className: \"button subtle-button\",\n        children: [/*#__PURE__*/_jsxDEV(FaQuestion, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 427,\n          columnNumber: 21\n        }, this), \" \\u0393\\u03C1\\u03AE\\u03B3\\u03BF\\u03C1\\u03B7 \\u03A0\\u03B5\\u03C1\\u03B9\\u03AE\\u03B3\\u03B7\\u03C3\\u03B7\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 426,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 424,\n      columnNumber: 13\n    }, this), (messages.error || messages.success) && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `message global-message ${messages.error ? 'error-message' : 'success-message'}`,\n      role: \"status\",\n      children: [messages.error || messages.success, /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: clearMessages,\n        title: \"\\u0391\\u03C0\\u03CC\\u03BA\\u03C1\\u03C5\\u03C8\\u03B7\",\n        \"aria-label\": \"Dismiss\",\n        children: \"X\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 434,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 432,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(DndContext, {\n      sensors: sensors,\n      collisionDetection: closestCenter,\n      onDragStart: handleDragStart,\n      onDragEnd: handleDragEnd,\n      measuring: {\n        droppable: {\n          strategy: MeasuringStrategy.Always\n        }\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"prompt-workshop-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"aside\", {\n          className: \"workshop-column palette\",\n          children: /*#__PURE__*/_jsxDEV(BlockPalette, {\n            blocksByCategory: initialPreMadeBlocks,\n            onAddBlock: handleAddBlock,\n            onAddCustom: handleAddCustomTextBlock\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 447,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 446,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"main\", {\n          className: \"workshop-column canvas\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"prompt-canvas-section widget\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"prompt-metadata-controls\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"prompt-meta-row-1\",\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"text\",\n                  placeholder: \"\\u038C\\u03BD\\u03BF\\u03BC\\u03B1 \\u0392\\u03BF\\u03B7\\u03B8\\u03BF\\u03CD AI (\\u0391\\u03C0\\u03B1\\u03B9\\u03C4\\u03B5\\u03AF\\u03C4\\u03B1\\u03B9)\",\n                  value: currentPrompt.name,\n                  onChange: handlePromptNameChange,\n                  className: \"prompt-name-input\",\n                  required: true,\n                  \"aria-label\": \"\\u038C\\u03BD\\u03BF\\u03BC\\u03B1 \\u0392\\u03BF\\u03B7\\u03B8\\u03BF\\u03CD AI\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 458,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"prompt-actions-main\",\n                  children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                    className: \"button primary-button\",\n                    onClick: handleSavePrompt,\n                    disabled: isSaving || !currentPrompt.name.trim(),\n                    children: [/*#__PURE__*/_jsxDEV(FaSave, {}, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 469,\n                      columnNumber: 45\n                    }, this), \" \", isSaving ? 'Αποθήκευση...' : currentPrompt.id ? 'Ενημέρωση' : 'Αποθήκευση']\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 468,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    onClick: handleNewPrompt,\n                    className: \"button subtle-button\",\n                    title: \"\\u039A\\u03B1\\u03B8\\u03B1\\u03C1\\u03B9\\u03C3\\u03BC\\u03CC\\u03C2 & \\u039D\\u03AD\\u03BF\\u03C2 \\u0392\\u03BF\\u03B7\\u03B8\\u03CC\\u03C2\",\n                    children: [/*#__PURE__*/_jsxDEV(FaSyncAlt, {}, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 472,\n                      columnNumber: 45\n                    }, this), \" \\u039D\\u03AD\\u03BF\\u03C2\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 471,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 467,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 457,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"prompt-meta-row-2\",\n                children: /*#__PURE__*/_jsxDEV(\"textarea\", {\n                  placeholder: \"\\u03A3\\u03CD\\u03BD\\u03C4\\u03BF\\u03BC\\u03B7 \\u03C0\\u03B5\\u03C1\\u03B9\\u03B3\\u03C1\\u03B1\\u03C6\\u03AE \\u03B3\\u03B9\\u03B1 \\u03C4\\u03BF\\u03C5\\u03C2 \\u03BC\\u03B1\\u03B8\\u03B7\\u03C4\\u03AD\\u03C2 (\\u03C0\\u03C1\\u03BF\\u03B1\\u03B9\\u03C1\\u03B5\\u03C4\\u03B9\\u03BA\\u03CC)...\",\n                  value: currentPrompt.description,\n                  onChange: handlePromptDescriptionChange,\n                  className: \"prompt-description-input\",\n                  rows: 2,\n                  \"aria-label\": \"\\u03A3\\u03CD\\u03BD\\u03C4\\u03BF\\u03BC\\u03B7 \\u03C0\\u03B5\\u03C1\\u03B9\\u03B3\\u03C1\\u03B1\\u03C6\\u03AE\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 477,\n                  columnNumber: 37\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 476,\n                columnNumber: 33\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"prompt-actions-extra\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"prompt-load-add-buttons\",\n                  children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                    className: \"button subtle-button\",\n                    onClick: () => setShowAddMaterialModal(true),\n                    title: \"\\u03A0\\u03C1\\u03BF\\u03C3\\u03B8\\u03AE\\u03BA\\u03B7 \\u03C0\\u03BB\\u03B1\\u03B9\\u03C3\\u03AF\\u03BF\\u03C5 \\u03B1\\u03C0\\u03CC \\u03C4\\u03BF \\u03C5\\u03BB\\u03B9\\u03BA\\u03CC \\u03C3\\u03B1\\u03C2\",\n                    children: [/*#__PURE__*/_jsxDEV(FaFileUpload, {}, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 489,\n                      columnNumber: 45\n                    }, this), \" \\u03A0\\u03C1\\u03BF\\u03C3\\u03B8\\u03AE\\u03BA\\u03B7 \\u03A5\\u03BB\\u03B9\\u03BA\\u03BF\\u03CD\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 488,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                    className: \"button subtle-button\",\n                    onClick: () => setShowLoadPromptModal(true),\n                    title: \"\\u03A6\\u03CC\\u03C1\\u03C4\\u03C9\\u03C3\\u03B7 \\u03B1\\u03C0\\u03BF\\u03B8\\u03B7\\u03BA\\u03B5\\u03C5\\u03BC\\u03AD\\u03BD\\u03BF\\u03C5 \\u03B2\\u03BF\\u03B7\\u03B8\\u03BF\\u03CD\",\n                    children: [/*#__PURE__*/_jsxDEV(FaHistory, {}, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 492,\n                      columnNumber: 45\n                    }, this), \" \\u03A6\\u03CC\\u03C1\\u03C4\\u03C9\\u03C3\\u03B7 \\u0392\\u03BF\\u03B7\\u03B8\\u03BF\\u03CD\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 491,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 487,\n                  columnNumber: 37\n                }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"prompt-public-toggle\",\n                  children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                    type: \"checkbox\",\n                    id: `is_public_toggle_PW_${currentPrompt.id || 'newP'}`,\n                    checked: currentPrompt.is_public,\n                    onChange: handlePromptPublicToggle,\n                    disabled: isSaving\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 496,\n                    columnNumber: 41\n                  }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                    htmlFor: `is_public_toggle_PW_${currentPrompt.id || 'newP'}`,\n                    className: currentPrompt.is_public ? 'is-public' : '',\n                    title: \"\\u039D\\u03B1 \\u03B5\\u03AF\\u03BD\\u03B1\\u03B9 \\u03B4\\u03B9\\u03B1\\u03B8\\u03AD\\u03C3\\u03B9\\u03BC\\u03BF\\u03C2 \\u03C3\\u03C4\\u03BF\\u03C5\\u03C2 \\u03BC\\u03B1\\u03B8\\u03B7\\u03C4\\u03AD\\u03C2;\",\n                    children: currentPrompt.is_public ? 'Δημόσιος (Για μαθητές)' : 'Ιδιωτικός (Μόνο για εκπαιδευτικούς)'\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 503,\n                    columnNumber: 41\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 495,\n                  columnNumber: 37\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 486,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 456,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(SortableContext, {\n              items: currentPrompt.structure.map(b => b.id),\n              strategy: verticalListSortingStrategy,\n              children: /*#__PURE__*/_jsxDEV(PromptBuilder, {\n                blocks: currentPrompt.structure,\n                onDeleteBlock: handleDeleteBlock,\n                onUpdateBlockContent: handleUpdateBlockContent,\n                activeId: activeId\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 514,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 513,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 455,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 454,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"aside\", {\n          className: \"workshop-column sandbox\",\n          children: /*#__PURE__*/_jsxDEV(Sandbox, {\n            currentPromptStructure: currentPrompt.structure,\n            systemPromptForSandbox: systemPromptForSandbox,\n            promptIdToUseIfNoStructure: currentPrompt.id,\n            showError: showError,\n            showSuccess: showSuccess,\n            clearMessages: clearMessages\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 525,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 524,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 445,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(DragOverlay, {\n        dropAnimation: null,\n        children: activeId && draggedBlockData ? /*#__PURE__*/_jsxDEV(SortableBlock, {\n          id: draggedBlockData.id,\n          block: draggedBlockData,\n          isDragging: true,\n          onDeleteBlock: () => {},\n          onUpdateBlockContent: () => {}\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 538,\n          columnNumber: 25\n        }, this) : null\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 536,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 438,\n      columnNumber: 13\n    }, this), showLoadPromptModal && /*#__PURE__*/_jsxDEV(Modal, {\n      title: \"\\u03A6\\u03CC\\u03C1\\u03C4\\u03C9\\u03C3\\u03B7 \\u0391\\u03C0\\u03BF\\u03B8\\u03B7\\u03BA\\u03B5\\u03C5\\u03BC\\u03AD\\u03BD\\u03BF\\u03C5 \\u0392\\u03BF\\u03B7\\u03B8\\u03BF\\u03CD\",\n      onClose: () => setShowLoadPromptModal(false),\n      width: \"700px\",\n      showFooter: true,\n      children: loadingState.promptDetails ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"loading-items modal-loading\",\n        children: [/*#__PURE__*/_jsxDEV(FaSpinner, {\n          className: \"spin\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 553,\n          columnNumber: 70\n        }, this), \" \\u039B\\u03AE\\u03C8\\u03B7 \\u03BB\\u03B5\\u03C0\\u03C4\\u03BF\\u03BC\\u03B5\\u03C1\\u03B5\\u03B9\\u03CE\\u03BD...\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 553,\n        columnNumber: 25\n      }, this) : /*#__PURE__*/_jsxDEV(PromptListForModal, {\n        prompts: savedPrompts,\n        onLoadPrompt: handleLoadPrompt,\n        isLoading: loadingState.prompts,\n        currentPromptId: currentPrompt.id,\n        showError: showError\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 555,\n        columnNumber: 25\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 551,\n      columnNumber: 17\n    }, this), showAddMaterialModal && /*#__PURE__*/_jsxDEV(Modal, {\n      title: \"\\u03A0\\u03C1\\u03BF\\u03C3\\u03B8\\u03AE\\u03BA\\u03B7 \\u03A0\\u03BB\\u03B1\\u03B9\\u03C3\\u03AF\\u03BF\\u03C5 \\u03B1\\u03C0\\u03CC \\u03A5\\u03BB\\u03B9\\u03BA\\u03CC\",\n      onClose: () => setShowAddMaterialModal(false),\n      width: \"700px\",\n      showFooter: true,\n      children: /*#__PURE__*/_jsxDEV(MaterialListForModal, {\n        materials: materials,\n        onMaterialClick: handleAddMaterialSummary,\n        isLoading: loadingState.materials,\n        showError: showError\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 567,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 566,\n      columnNumber: 17\n    }, this), isTutorialActive && guidedSteps[tutorialStep] && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"tutorial-overlay-backdrop\",\n        onClick: endTutorial,\n        \"aria-hidden\": \"true\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 579,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: tooltipRef,\n        className: \"tutorial-tooltip\",\n        style: {\n          top: tooltipPos.top,\n          left: tooltipPos.left,\n          position: 'fixed'\n        },\n        \"data-placement\": tooltipPos.placement,\n        role: \"dialog\",\n        \"aria-modal\": \"true\",\n        \"aria-live\": \"polite\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: guidedSteps[tutorialStep].content\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 589,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"tutorial-footer\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: [\"\\u0392\\u03AE\\u03BC\\u03B1 \", tutorialStep + 1, \" \\u03B1\\u03C0\\u03CC \", guidedSteps.length]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 592,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"tutorial-buttons\",\n            children: [tutorialStep > 0 && /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: prevTutorialStep,\n              className: \"button subtle-button small\",\n              autoFocus: true,\n              children: \"\\u03A0\\u03C1\\u03BF\\u03B7\\u03B3\\u03BF\\u03CD\\u03BC\\u03B5\\u03BD\\u03BF\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 595,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: endTutorial,\n              className: \"button subtle-button small close-tutorial\",\n              children: \"\\u03A0\\u03B1\\u03C1\\u03AC\\u03BB\\u03B5\\u03B9\\u03C8\\u03B7\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 599,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: nextTutorialStep,\n              className: \"button primary-button small\",\n              children: tutorialStep < guidedSteps.length - 1 ? 'Επόμενο' : 'Τέλος'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 602,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 593,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 591,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 580,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 423,\n    columnNumber: 9\n  }, this);\n}\n_s(PromptWorkshop, \"7QAkoVlHdhnaePrZwO8I0D9lXJU=\", false, function () {\n  return [useSensors, useSensor, useSensor];\n});\n_c = PromptWorkshop;\nexport default PromptWorkshop;\nvar _c;\n$RefreshReg$(_c, \"PromptWorkshop\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","useRef","DndContext","DragOverlay","closestCenter","PointerSensor","KeyboardSensor","useSensor","useSensors","MeasuringStrategy","SortableContext","arrayMove","verticalListSortingStrategy","sortableKeyboardCoordinates","v4","uuidv4","BlockPalette","PromptBuilder","SortableBlock","Sandbox","Modal","MaterialListForModal","PromptListForModal","getMaterials","getTeacherPrompts","savePrompt","updatePrompt","getPromptDetails","FaSave","FaEdit","FaFileUpload","FaHistory","FaQuestion","FaSyncAlt","FaSpinner","jsxDEV","_jsxDEV","Fragment","_Fragment","BlockTypes","PALETTE_ITEM","CANVAS_BLOCK","MATERIAL_SUMMARY","CUSTOM_TEXT","initialPreMadeBlocks","id","type","title","content","guidedSteps","selector","PromptWorkshop","_s","materials","setMaterials","savedPrompts","setSavedPrompts","currentPrompt","setCurrentPrompt","name","description","is_public","structure","system_prompt","activeId","setActiveId","loadingState","setLoadingState","prompts","promptDetails","isSaving","setIsSaving","messages","setMessages","error","success","showLoadPromptModal","setShowLoadPromptModal","showAddMaterialModal","setShowAddMaterialModal","isTutorialActive","setIsTutorialActive","tutorialStep","setTutorialStep","highlightedElementRef","tooltipRef","tooltipPos","setTooltipPos","top","left","placement","focusables","setFocusables","sensors","activationConstraint","distance","coordinateGetter","clearMessages","showSuccess","msg","dur","setTimeout","showError","fetchAllMaterials","s","r","data","e","console","fetchAllPrompts","handleAddBlock","blockFromPalette","newBlock","p","handleAddMaterialSummary","material","summaryBlock","isMaterialBlock","materialId","materialName","prev","handleAddCustomTextBlock","nb","handleDeleteBlock","filter","b","handleUpdateBlockContent","map","handlePromptNameChange","target","value","handlePromptDescriptionChange","handlePromptPublicToggle","checked","handleSavePrompt","trim","payload","response","updatedDetails","err","_err$response","_err$response$data","handleLoadPrompt","promptToLoad","fp","Array","isArray","handleNewPrompt","handleDragStart","event","active","handleDragEnd","over","oldIdx","findIndex","i","newIdx","draggedBlockData","find","systemPromptForSandbox","block","join","startTutorial","nextTutorialStep","length","prevTutorialStep","endTutorial","current","classList","remove","positionTooltipFor","element","rect","getBoundingClientRect","tW","offsetWidth","tH","offsetHeight","gap","pad","right","height","fitsRight","window","innerWidth","fitsLeft","fitsBottom","bottom","innerHeight","fitsTop","width","Math","max","min","prevOverflow","document","body","style","overflow","step","querySelector","scrollIntoView","behavior","inline","scrollBy","add","nodes","from","querySelectorAll","el","hasAttribute","getAttribute","primary","focus","handleResize","handleScroll","handleKey","key","preventDefault","first","last","shiftKey","activeElement","addEventListener","passive","removeEventListener","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","role","collisionDetection","onDragStart","onDragEnd","measuring","droppable","strategy","Always","blocksByCategory","onAddBlock","onAddCustom","placeholder","onChange","required","disabled","rows","htmlFor","items","blocks","onDeleteBlock","onUpdateBlockContent","currentPromptStructure","promptIdToUseIfNoStructure","dropAnimation","isDragging","onClose","showFooter","onLoadPrompt","isLoading","currentPromptId","onMaterialClick","ref","position","autoFocus","_c","$RefreshReg$"],"sources":["/Users/tommys/Desktop/ai14/frontend/src/components/Dashboard/PromptWorkshop.js"],"sourcesContent":["import React, { useState, useEffect, useCallback, useRef } from 'react';\nimport {\n    DndContext, DragOverlay, closestCenter, PointerSensor, KeyboardSensor,\n    useSensor, useSensors, MeasuringStrategy\n} from '@dnd-kit/core';\nimport {\n    SortableContext, arrayMove, verticalListSortingStrategy, sortableKeyboardCoordinates\n} from '@dnd-kit/sortable';\nimport { v4 as uuidv4 } from 'uuid';\n\nimport BlockPalette from './BlockPalette';\nimport PromptBuilder from './PromptBuilder/PromptBuilder';\nimport SortableBlock from './PromptBuilder/SortableBlock';\nimport Sandbox from './Sandbox';\nimport Modal from '../common/Modal';\nimport MaterialListForModal from './MaterialListForModal';\nimport PromptListForModal from './PromptListForModal';\n\nimport { getMaterials, getTeacherPrompts, savePrompt, updatePrompt, getPromptDetails } from '../../services/api';\n\nimport { FaSave, FaEdit, FaFileUpload, FaHistory, FaQuestion, FaSyncAlt, FaSpinner } from 'react-icons/fa';\n\nimport '../../styles/PromptWorkshop.css';\n\n// Block Types Definition (καμία αλλαγή)\nexport const BlockTypes = {\n    PALETTE_ITEM: 'palette-item',\n    CANVAS_BLOCK: 'canvas-block',\n    MATERIAL_SUMMARY: 'material-summary',\n    CUSTOM_TEXT: 'custom-text',\n};\n\n// Μεταφρασμένα και βελτιωμένα μπλοκ οδηγιών (unchanged)\nconst initialPreMadeBlocks = {\n    '🎯 Βασικός Ρόλος & Προσωπικότητα': [\n        { id: 'core-task-1', type: BlockTypes.PALETTE_ITEM, title: 'Κύριος Ρόλος', content: 'Λειτούργησε ως ένας εξυπηρετικός ψηφιακός βοηθός διδασκαλίας για μαθητές [Τάξη/Επίπεδο], με ειδίκευση στο μάθημα [Μάθημα/Θέμα].' },\n        { id: 'persona-expert-1', type: BlockTypes.PALETTE_ITEM, title: 'Προσωπικότητα Ειδικού', content: 'Υιοθέτησε την προσωπικότητα ενός ειδικού με γνώσεις και μεταδοτικότητα στο αντικείμενο [Μάθημα/Θέμα]. Εξήγησε τις έννοιες με σαφήνεια.' },\n        { id: 'persona-mentor-1', type: BlockTypes.PALETTE_ITEM, title: 'Προσωπικότητα Μέντορα', content: 'Υιοθέτησε την προσωπικότητα ενός υποστηρικτικού μέντορα, καθοδηγώντας τους μαθητές στο μαθησιακό τους ταξίδι.' },\n    ],\n    '🗣️ Ύφος & Τόνος': [\n        { id: 'tone-friendly-1', type: BlockTypes.PALETTE_ITEM, title: 'Φιλικό & Ενθαρρυντικό Ύφος', content: 'Διατήρησε έναν φιλικό, υπομονετικό και ενθαρρυντικό τόνο σε όλη τη συζήτηση. Χρησιμοποίησε θετική ενίσχυση.' },\n        { id: 'tone-formal-1', type: BlockTypes.PALETTE_ITEM, title: 'Επίσημο & Ακαδημαϊκό Ύφος', content: 'Υιοθέτησε ένα επίσημο, αντικειμενικό και ακαδημαϊκό ύφος, κατάλληλο για μελέτη.' },\n        { id: 'style-concise-1', type: BlockTypes.PALETTE_ITEM, title: 'Συνοπτικές Απαντήσεις', content: 'Κράτα τις εξηγήσεις σου σαφείς, περιεκτικές και όσο το δυνατόν πιο σύντομες, χωρίς να χάνεται το νόημα.' },\n        { id: 'style-detailed-1', type: BlockTypes.PALETTE_ITEM, title: 'Αναλυτικές Εξηγήσεις', content: 'Παρείχε αναλυτικές εξηγήσεις, προσφέροντας υπόβαθρο, παραδείγματα και αναλογίες όπου είναι χρήσιμο.' },\n    ],\n    '📚 Πλαίσιο & Γνώση': [\n        { id: 'ctx-material-1', type: BlockTypes.PALETTE_ITEM, title: 'Χρήση ΜΟΝΟ του Υλικού', content: 'Βάσισε αυστηρά τις απαντήσεις και τις εξηγήσεις σου στο διδακτικό υλικό που παρέχεται. Εάν μια πληροφορία δεν υπάρχει, δήλωσέ το ξεκάθαρα και μην επινοείς απαντήσεις.' },\n        { id: 'ctx-refer-material-1', type: BlockTypes.PALETTE_ITEM, title: 'Αναφορά σε Συγκεκριμένο Υλικό', content: 'Όταν απαντάς, να αναφέρεσαι ρητά σε συγκεκριμένες ενότητες ή ιδέες από το [Όνομα Μπλοκ Υλικού], εάν είναι σχετικό.' },\n    ],\n    '💡 Διδακτικές Στρατηγικές': [\n        { id: 'strat-socratic-1', type: BlockTypes.PALETTE_ITEM, title: 'Σωκρατική Μέθοδος', content: 'Αντί να δίνεις άμεσες απαντήσεις, καθοδήγησε τους μαθητές κάνοντας μια σειρά από διερευνητικές ερωτήσεις για να τους βοηθήσεις να φτάσουν στη λύση μόνοι τους.' },\n        { id: 'strat-stepbystep-1', type: BlockTypes.PALETTE_ITEM, title: 'Ανάλυση Βήμα-Βήμα', content: 'Για σύνθετα προβλήματα ή διαδικασίες, ανάλυσέ τα σε μικρότερα, λογικά και εύκολα βήματα. Εξήγησε κάθε βήμα με σαφήνεια.' },\n        { id: 'strat-analogy-1', type: BlockTypes.PALETTE_ITEM, title: 'Χρήση Αναλογιών', content: 'Χρησιμοποίησε σχετικές αναλογίες και παραδείγματα από την καθημερινή ζωή για να κάνεις τις αφηρημένες έννοιες πιο κατανοητές.' },\n    ],\n    '✅ Παραδείγματα & Υποστήριξη': [\n        { id: 'ex-positive-1', type: BlockTypes.PALETTE_ITEM, title: 'Παράδειγμα Διαλόγου', content: 'Παράδειγμα Ερώτησης Μαθητή: [Απλή Ερώτηση]\\nΠαράδειγμα Σωστής Απάντησης Βοηθού: [Σαφής, βοηθητική, καθοδηγητική απάντηση βασισμένη στην προσωπικότητα/ύφος σου]' },\n        { id: 'scaffold-hints-1', type: BlockTypes.PALETTE_ITEM, title: 'Παροχή Υποδείξεων', content: 'Εάν ένας μαθητής έχει κολλήσει, πρόσφερε μια μικρή υπόδειξη ή μια υπενθύμιση μιας σχετικής έννοιας πριν δώσεις πιο άμεση βοήθεια.' },\n    ],\n    '🛡️ Ασφάλεια & Δεοντολογία': [\n        { id: 'safe-offtopic-1', type: BlockTypes.PALETTE_ITEM, title: 'Άρνηση Άσχετων Ερωτήσεων', content: 'Αρνήσου ευγενικά να απαντήσεις σε ερωτήσεις που είναι άσχετες με το μάθημα, ακατάλληλες, επιβλαβείς, ανήθικες ή ζητούν προσωπικές πληροφορίες.' },\n        { id: 'safe-no-pii-1', type: BlockTypes.PALETTE_ITEM, title: 'Όχι Προσωπικά Δεδομένα', content: 'Μην ζητάς, αποθηκεύεις ή μοιράζεσαι ποτέ προσωπικά δεδομένα (ΠΔ) από ή για τον μαθητή ή άλλους.' },\n    ]\n};\n\n// Μεταφρασμένα βήματα περιήγησης (unchanged copy/text)\nconst guidedSteps = [\n    { selector: '.workshop-column.palette', content: '1. Βιβλιοθήκη Μπλοκ: Εδώ βρίσκονται έτοιμες παιδαγωγικές οδηγίες. Κάντε κλικ σε μία για να την προσθέσετε στον καμβά.' },\n    { selector: '.workshop-column.canvas', content: '2. Καμβάς Οδηγιών: Συνθέστε τις οδηγίες του βοηθού εδώ. Σύρετε τα μπλοκ για να αλλάξετε τη σειρά τους.' },\n    { selector: '.prompt-metadata-controls', content: '3. Λεπτομέρειες & Ενέργειες: Δώστε όνομα, περιγραφή και ορατότητα στον βοηθό σας. Από εδώ μπορείτε να αποθηκεύσετε, να φορτώσετε ή να προσθέσετε υλικό.' },\n    { selector: '.workshop-column.sandbox', content: '4. Περιοχή Δοκιμών: Δοκιμάστε τον βοηθό σας σε πραγματικό χρόνο! Γράψτε μια ερώτηση μαθητή για να δείτε πώς απαντά.' }\n];\n\nfunction PromptWorkshop() {\n    const [materials, setMaterials] = useState([]);\n    const [savedPrompts, setSavedPrompts] = useState([]);\n    const [currentPrompt, setCurrentPrompt] = useState({ id: null, name: '', description: '', is_public: false, structure: [], system_prompt: '' });\n    const [activeId, setActiveId] = useState(null);\n    const [loadingState, setLoadingState] = useState({ materials: true, prompts: true, promptDetails: false });\n    const [isSaving, setIsSaving] = useState(false);\n    const [messages, setMessages] = useState({ error: '', success: '' });\n    const [showLoadPromptModal, setShowLoadPromptModal] = useState(false);\n    const [showAddMaterialModal, setShowAddMaterialModal] = useState(false);\n\n    // --- Quick Tour state (enhanced) ---\n    const [isTutorialActive, setIsTutorialActive] = useState(false);\n    const [tutorialStep, setTutorialStep] = useState(0);\n    const highlightedElementRef = useRef(null);\n    const tooltipRef = useRef(null);\n    const [tooltipPos, setTooltipPos] = useState({ top: 24, left: 24, placement: 'right' });\n    const [focusables, setFocusables] = useState([]);\n\n    const sensors = useSensors(\n        useSensor(PointerSensor, { activationConstraint: { distance: 8 } }),\n        useSensor(KeyboardSensor, { coordinateGetter: sortableKeyboardCoordinates })\n    );\n\n    const clearMessages = useCallback(() => setMessages({ error: '', success: '' }), []);\n    const showSuccess = useCallback((msg, dur = 3500) => { setMessages({ error: '', success: msg }); setTimeout(clearMessages, dur); }, [clearMessages]);\n    const showError = useCallback((msg) => { setMessages({ error: msg, success: '' }); }, []);\n\n    const fetchAllMaterials = useCallback(async () => {\n        setLoadingState(s => ({ ...s, materials: true }));\n        try {\n            const r = await getMaterials();\n            setMaterials(r.data || []);\n        } catch (e) {\n            console.error(\"Error fetching materials:\", e);\n            showError(\"Αδυναμία φόρτωσης υλικών.\");\n            setMaterials([]);\n        } finally {\n            setLoadingState(s => ({ ...s, materials: false }));\n        }\n    }, [showError]);\n\n    const fetchAllPrompts = useCallback(async () => {\n        setLoadingState(s => ({ ...s, prompts: true }));\n        try {\n            const r = await getTeacherPrompts();\n            setSavedPrompts(r.data || []);\n        } catch (e) {\n            console.error(\"Error fetching prompts:\", e);\n            showError(\"Αδυναμία φόρτωσης αποθηκευμένων βοηθών.\");\n            setSavedPrompts([]);\n        } finally {\n            setLoadingState(s => ({ ...s, prompts: false }));\n        }\n    }, [showError]);\n\n    useEffect(() => { fetchAllMaterials(); fetchAllPrompts(); }, [fetchAllMaterials, fetchAllPrompts]);\n\n    const handleAddBlock = useCallback((blockFromPalette) => {\n        clearMessages();\n        const newBlock = {\n            id: `canvas-${uuidv4()}`,\n            type: BlockTypes.CANVAS_BLOCK,\n            title: blockFromPalette.title,\n            content: blockFromPalette.content,\n        };\n        setCurrentPrompt(p => ({ ...p, structure: [...p.structure, newBlock] }));\n    }, [clearMessages]);\n\n    const handleAddMaterialSummary = useCallback((material) => {\n        clearMessages();\n        if (!material?.id) { showError(\"Επιλέχθηκε μη έγκυρο υλικό.\"); return; }\n        const summaryBlock = {\n            id: `mat-${material.id}-${uuidv4()}`,\n            type: BlockTypes.MATERIAL_SUMMARY,\n            title: `📄 Πλαίσιο από: ${material.name}`,\n            content: `[USE_FULL_TEXT_FROM_MATERIAL_ID:${material.id}] Πληροφορίες από το υλικό με τίτλο \"${material.name}\".`,\n            isMaterialBlock: true,\n            materialId: material.id,\n            materialName: material.name\n        };\n        setCurrentPrompt(prev => ({ ...prev, structure: [...prev.structure, summaryBlock] }));\n        showSuccess(`Προστέθηκε το πλαίσιο από \"${material.name}\" (το AI θα χρησιμοποιήσει το πλήρες κείμενο).`);\n        setShowAddMaterialModal(false);\n    }, [clearMessages, showError, showSuccess]);\n\n    const handleAddCustomTextBlock = useCallback(() => {\n        clearMessages();\n        const nb = { id: `custom-${uuidv4()}`, type: BlockTypes.CUSTOM_TEXT, title: '✏️ Προσαρμοσμένη Οδηγία', content: 'Εισαγάγετε τη δική σας οδηγία...' };\n        setCurrentPrompt(p => ({ ...p, structure: [...p.structure, nb] }));\n    }, [clearMessages]);\n\n    const handleDeleteBlock = useCallback((id) => {\n        clearMessages();\n        setCurrentPrompt(p => ({ ...p, structure: p.structure.filter(b => b.id !== id) }));\n    }, [clearMessages]);\n\n    const handleUpdateBlockContent = useCallback((id, content) => {\n        clearMessages();\n        setCurrentPrompt(p => ({ ...p, structure: p.structure.map(b => b.id === id ? { ...b, content } : b) }));\n    }, [clearMessages]);\n\n    const handlePromptNameChange = (e) => setCurrentPrompt(p => ({ ...p, name: e.target.value }));\n    const handlePromptDescriptionChange = (e) => setCurrentPrompt(p => ({ ...p, description: e.target.value }));\n    const handlePromptPublicToggle = (e) => setCurrentPrompt(p => ({ ...p, is_public: e.target.checked }));\n\n    const handleSavePrompt = useCallback(async () => {\n        clearMessages();\n        if (!currentPrompt.name.trim()) { showError(\"Το όνομα του βοηθού AI είναι απαραίτητο.\"); return; }\n        setIsSaving(true);\n        const payload = {\n            name: currentPrompt.name.trim(),\n            description: currentPrompt.description.trim(),\n            is_public: currentPrompt.is_public,\n            structure: currentPrompt.structure\n        };\n        try {\n            let response; let msg = '';\n            if (currentPrompt.id) {\n                response = await updatePrompt(currentPrompt.id, payload);\n                msg = `Ο βοηθός \"${response.data.name}\" ενημερώθηκε επιτυχώς.`;\n                setSavedPrompts(prev => prev.map(p => p.id === response.data.id ? { ...p, ...response.data } : p));\n                const updatedDetails = await getPromptDetails(currentPrompt.id);\n                setCurrentPrompt(prev => ({ ...prev, ...updatedDetails.data }));\n            } else {\n                response = await savePrompt(payload);\n                msg = `Ο βοηθός \"${response.data.name}\" δημιουργήθηκε επιτυχώς.`;\n                setCurrentPrompt(prev => ({ ...prev, id: response.data.id, ...response.data, system_prompt: response.data.system_prompt }));\n                setSavedPrompts(prev => [response.data, ...prev]);\n            }\n            showSuccess(msg);\n        } catch (err) {\n            console.error(\"Error saving prompt:\", err);\n            showError(err.response?.data?.error || \"Αποτυχία αποθήκευσης του βοηθού AI.\");\n        } finally {\n            setIsSaving(false);\n        }\n    }, [currentPrompt, showError, showSuccess, clearMessages]);\n\n    const handleLoadPrompt = useCallback(async (promptToLoad) => {\n        clearMessages();\n        if (!promptToLoad?.id) { showError(\"Επιλέχθηκε μη έγκυρος βοηθός.\"); setShowLoadPromptModal(false); return; }\n        setLoadingState(s => ({ ...s, promptDetails: true }));\n        try {\n            const response = await getPromptDetails(promptToLoad.id);\n            const fp = response.data;\n            setCurrentPrompt({\n                id: fp.id, name: fp.name || '', description: fp.description || '',\n                is_public: !!fp.is_public,\n                structure: Array.isArray(fp.structure) ? fp.structure : [],\n                system_prompt: fp.system_prompt || ''\n            });\n            showSuccess(`Φορτώθηκε ο βοηθός: \"${fp.name}\"`);\n        } catch (err) {\n            console.error(\"Error loading prompt details:\", err);\n            showError(`Αποτυχία φόρτωσης του \"${promptToLoad.name}\".`);\n        } finally {\n            setLoadingState(s => ({ ...s, promptDetails: false }));\n            setShowLoadPromptModal(false);\n        }\n    }, [showError, showSuccess, clearMessages]);\n\n    const handleNewPrompt = useCallback(() => {\n        clearMessages();\n        setCurrentPrompt({ id: null, name: '', description: '', is_public: false, structure: [], system_prompt: '' });\n        showSuccess(\"Ο καμβάς είναι έτοιμος για ένα νέο βοηθό.\");\n    }, [clearMessages, showSuccess]);\n\n    const handleDragStart = (event) => { clearMessages(); setActiveId(event.active.id); };\n    const handleDragEnd = (event) => {\n        const { active, over } = event;\n        setActiveId(null);\n        if (over && active.id !== over.id) {\n            const oldIdx = currentPrompt.structure.findIndex(i => i.id === active.id);\n            const newIdx = currentPrompt.structure.findIndex(i => i.id === over.id);\n            if (oldIdx !== -1 && newIdx !== -1) {\n                setCurrentPrompt(p => ({ ...p, structure: arrayMove(p.structure, oldIdx, newIdx) }));\n            }\n        }\n    };\n    const draggedBlockData = activeId ? currentPrompt.structure.find(b => b.id === activeId) : null;\n    const systemPromptForSandbox = currentPrompt.system_prompt ? currentPrompt.system_prompt : currentPrompt.structure.map(block => block.content).join(\"\\n\\n\");\n\n    // -----------------------------\n    // Quick Tour: helpers & effects\n    // -----------------------------\n    const startTutorial = () => {\n        setIsTutorialActive(true);\n        setTutorialStep(0);\n    };\n    const nextTutorialStep = () => {\n        if (tutorialStep < guidedSteps.length - 1) setTutorialStep(s => s + 1);\n        else setIsTutorialActive(false);\n    };\n    const prevTutorialStep = () => {\n        if (tutorialStep > 0) setTutorialStep(s => s - 1);\n    };\n    const endTutorial = useCallback(() => {\n        if (highlightedElementRef.current) {\n            highlightedElementRef.current.classList.remove('tutorial-highlight');\n            highlightedElementRef.current = null;\n        }\n        setIsTutorialActive(false);\n    }, []);\n\n    // Smart tooltip positioning near the highlighted element\n    const positionTooltipFor = useCallback((element) => {\n        if (!element) return;\n        const rect = element.getBoundingClientRect();\n        const tW = (tooltipRef.current && tooltipRef.current.offsetWidth) || 360;\n        const tH = (tooltipRef.current && tooltipRef.current.offsetHeight) || 180;\n        const gap = 12;\n        const pad = 12;\n\n        // prefer right -> left -> bottom -> top\n        let left = rect.right + gap;\n        let top = rect.top + rect.height / 2 - tH / 2;\n        let placement = 'right';\n\n        const fitsRight = (left + tW + pad) <= window.innerWidth;\n        const fitsLeft = (rect.left - gap - tW - pad) >= 0;\n        const fitsBottom = (rect.bottom + gap + tH + pad) <= window.innerHeight;\n        const fitsTop = (rect.top - gap - tH - pad) >= 0;\n\n        if (!fitsRight) {\n            if (fitsLeft) {\n                left = rect.left - gap - tW;\n                top = rect.top + rect.height / 2 - tH / 2;\n                placement = 'left';\n            } else if (fitsBottom) {\n                left = rect.left + rect.width / 2 - tW / 2;\n                top = rect.bottom + gap;\n                placement = 'bottom';\n            } else {\n                left = rect.left + rect.width / 2 - tW / 2;\n                top = rect.top - gap - tH;\n                placement = 'top';\n            }\n        }\n\n        // clamp into viewport\n        left = Math.max(pad, Math.min(left, window.innerWidth - tW - pad));\n        top = Math.max(pad, Math.min(top, window.innerHeight - tH - pad));\n\n        setTooltipPos({ left, top, placement });\n    }, []);\n\n    // Reposition + highlight per step\n    useEffect(() => {\n        if (!isTutorialActive) return;\n\n        // lock scroll while touring\n        const prevOverflow = document.body.style.overflow;\n        document.body.style.overflow = 'hidden';\n\n        // remove previous highlight\n        if (highlightedElementRef.current) {\n            highlightedElementRef.current.classList.remove('tutorial-highlight');\n            highlightedElementRef.current = null;\n        }\n\n        const step = guidedSteps[tutorialStep];\n        let element = null;\n\n        try {\n            element = step && step.selector ? document.querySelector(step.selector) : null;\n        } catch {\n            element = null;\n        }\n\n        if (element) {\n            element.scrollIntoView({ behavior: 'smooth', block: 'center', inline: 'nearest' });\n            // adjust for sticky header\n            setTimeout(() => {\n                try { window.scrollBy({ top: -80, left: 0, behavior: 'auto' }); } catch {}\n            }, 220);\n\n            element.classList.add('tutorial-highlight');\n            highlightedElementRef.current = element;\n\n            // position the tooltip after it renders, then set focusables\n            setTimeout(() => {\n                positionTooltipFor(element);\n                if (!tooltipRef.current) return;\n                const selector = [\n                    'button', '[href]', 'input', 'select', 'textarea',\n                    '[tabindex]:not([tabindex=\"-1\"])'\n                ].join(',');\n                const nodes = Array.from(tooltipRef.current.querySelectorAll(selector))\n                    .filter(el => !el.hasAttribute('disabled') && !el.getAttribute('aria-hidden'));\n                setFocusables(nodes);\n                const primary = tooltipRef.current.querySelector('.button.primary-button');\n                (primary || nodes[0]) && (primary || nodes[0]).focus();\n            }, 0);\n        } else {\n            // center tooltip if element missing\n            setTooltipPos({\n                top: window.innerHeight / 2 - 120,\n                left: window.innerWidth / 2 - 200,\n                placement: 'bottom'\n            });\n            setTimeout(() => {\n                if (!tooltipRef.current) return;\n                const selector = [\n                    'button', '[href]', 'input', 'select', 'textarea',\n                    '[tabindex]:not([tabindex=\"-1\"])'\n                ].join(',');\n                const nodes = Array.from(tooltipRef.current.querySelectorAll(selector))\n                    .filter(el => !el.hasAttribute('disabled') && !el.getAttribute('aria-hidden'));\n                setFocusables(nodes);\n                const primary = tooltipRef.current.querySelector('.button.primary-button');\n                (primary || nodes[0]) && (primary || nodes[0]).focus();\n            }, 0);\n        }\n\n        const handleResize = () => {\n            if (highlightedElementRef.current) positionTooltipFor(highlightedElementRef.current);\n        };\n        const handleScroll = () => {\n            if (highlightedElementRef.current) positionTooltipFor(highlightedElementRef.current);\n        };\n        const handleKey = (e) => {\n            if (!isTutorialActive) return;\n\n            if (e.key === 'Escape') { e.preventDefault(); endTutorial(); return; }\n            if (e.key === 'ArrowRight' || e.key === 'Enter') { e.preventDefault(); nextTutorialStep(); return; }\n            if (e.key === 'ArrowLeft') { e.preventDefault(); prevTutorialStep(); return; }\n\n            // focus trap\n            if (e.key === 'Tab' && focusables.length) {\n                const first = focusables[0];\n                const last = focusables[focusables.length - 1];\n                if (e.shiftKey && document.activeElement === first) { e.preventDefault(); last.focus(); }\n                else if (!e.shiftKey && document.activeElement === last) { e.preventDefault(); first.focus(); }\n            }\n        };\n\n        window.addEventListener('resize', handleResize, { passive: true });\n        window.addEventListener('scroll', handleScroll, { passive: true });\n        window.addEventListener('keydown', handleKey);\n\n        return () => {\n            window.removeEventListener('resize', handleResize);\n            window.removeEventListener('scroll', handleScroll);\n            window.removeEventListener('keydown', handleKey);\n            document.body.style.overflow = prevOverflow;\n        };\n    }, [isTutorialActive, tutorialStep, positionTooltipFor, endTutorial, focusables.length]);\n\n    return (\n        <div className=\"prompt-workshop-page page-content-wrapper\">\n            <div className=\"page-header\">\n                <h2><FaEdit /> Εργαστήριο Βοηθών AI</h2>\n                <button onClick={startTutorial} className=\"button subtle-button\">\n                    <FaQuestion /> Γρήγορη Περιήγηση\n                </button>\n            </div>\n\n            {(messages.error || messages.success) &&\n                <div className={`message global-message ${messages.error ? 'error-message' : 'success-message'}`} role=\"status\">\n                    {messages.error || messages.success}\n                    <button onClick={clearMessages} title=\"Απόκρυψη\" aria-label=\"Dismiss\">X</button>\n                </div>\n            }\n\n            <DndContext\n                sensors={sensors}\n                collisionDetection={closestCenter}\n                onDragStart={handleDragStart}\n                onDragEnd={handleDragEnd}\n                measuring={{ droppable: { strategy: MeasuringStrategy.Always } }}\n            >\n                <div className=\"prompt-workshop-container\">\n                    <aside className=\"workshop-column palette\">\n                        <BlockPalette\n                            blocksByCategory={initialPreMadeBlocks}\n                            onAddBlock={handleAddBlock}\n                            onAddCustom={handleAddCustomTextBlock}\n                        />\n                    </aside>\n\n                    <main className=\"workshop-column canvas\">\n                        <div className=\"prompt-canvas-section widget\">\n                            <div className=\"prompt-metadata-controls\">\n                                <div className=\"prompt-meta-row-1\">\n                                    <input\n                                        type=\"text\"\n                                        placeholder=\"Όνομα Βοηθού AI (Απαιτείται)\"\n                                        value={currentPrompt.name}\n                                        onChange={handlePromptNameChange}\n                                        className=\"prompt-name-input\"\n                                        required\n                                        aria-label=\"Όνομα Βοηθού AI\"\n                                    />\n                                    <div className=\"prompt-actions-main\">\n                                        <button className=\"button primary-button\" onClick={handleSavePrompt} disabled={isSaving || !currentPrompt.name.trim()}>\n                                            <FaSave /> {isSaving ? 'Αποθήκευση...' : (currentPrompt.id ? 'Ενημέρωση' : 'Αποθήκευση')}\n                                        </button>\n                                        <button onClick={handleNewPrompt} className=\"button subtle-button\" title=\"Καθαρισμός & Νέος Βοηθός\">\n                                            <FaSyncAlt /> Νέος\n                                        </button>\n                                    </div>\n                                </div>\n                                <div className=\"prompt-meta-row-2\">\n                                    <textarea\n                                        placeholder=\"Σύντομη περιγραφή για τους μαθητές (προαιρετικό)...\"\n                                        value={currentPrompt.description}\n                                        onChange={handlePromptDescriptionChange}\n                                        className=\"prompt-description-input\"\n                                        rows={2}\n                                        aria-label=\"Σύντομη περιγραφή\"\n                                    />\n                                </div>\n                                <div className=\"prompt-actions-extra\">\n                                    <div className=\"prompt-load-add-buttons\">\n                                        <button className=\"button subtle-button\" onClick={() => setShowAddMaterialModal(true)} title=\"Προσθήκη πλαισίου από το υλικό σας\">\n                                            <FaFileUpload /> Προσθήκη Υλικού\n                                        </button>\n                                        <button className=\"button subtle-button\" onClick={() => setShowLoadPromptModal(true)} title=\"Φόρτωση αποθηκευμένου βοηθού\">\n                                            <FaHistory /> Φόρτωση Βοηθού\n                                        </button>\n                                    </div>\n                                    <div className=\"prompt-public-toggle\">\n                                        <input\n                                            type=\"checkbox\"\n                                            id={`is_public_toggle_PW_${currentPrompt.id || 'newP'}`}\n                                            checked={currentPrompt.is_public}\n                                            onChange={handlePromptPublicToggle}\n                                            disabled={isSaving}\n                                        />\n                                        <label\n                                            htmlFor={`is_public_toggle_PW_${currentPrompt.id || 'newP'}`}\n                                            className={currentPrompt.is_public ? 'is-public' : ''}\n                                            title=\"Να είναι διαθέσιμος στους μαθητές;\"\n                                        >\n                                            {currentPrompt.is_public ? 'Δημόσιος (Για μαθητές)' : 'Ιδιωτικός (Μόνο για εκπαιδευτικούς)'}\n                                        </label>\n                                    </div>\n                                </div>\n                            </div>\n                            <SortableContext items={currentPrompt.structure.map(b => b.id)} strategy={verticalListSortingStrategy}>\n                                <PromptBuilder\n                                    blocks={currentPrompt.structure}\n                                    onDeleteBlock={handleDeleteBlock}\n                                    onUpdateBlockContent={handleUpdateBlockContent}\n                                    activeId={activeId}\n                                />\n                            </SortableContext>\n                        </div>\n                    </main>\n\n                    <aside className=\"workshop-column sandbox\">\n                        <Sandbox\n                            currentPromptStructure={currentPrompt.structure}\n                            systemPromptForSandbox={systemPromptForSandbox}\n                            promptIdToUseIfNoStructure={currentPrompt.id}\n                            showError={showError}\n                            showSuccess={showSuccess}\n                            clearMessages={clearMessages}\n                        />\n                    </aside>\n                </div>\n\n                <DragOverlay dropAnimation={null}>\n                    {activeId && draggedBlockData ? (\n                        <SortableBlock\n                            id={draggedBlockData.id}\n                            block={draggedBlockData}\n                            isDragging={true}\n                            onDeleteBlock={() => {}}\n                            onUpdateBlockContent={() => {}}\n                        />\n                    ) : null}\n                </DragOverlay>\n            </DndContext>\n\n            {/* Modals (unchanged) */}\n            {showLoadPromptModal && (\n                <Modal title=\"Φόρτωση Αποθηκευμένου Βοηθού\" onClose={() => setShowLoadPromptModal(false)} width=\"700px\" showFooter={true}>\n                    {loadingState.promptDetails ? (\n                        <div className=\"loading-items modal-loading\"><FaSpinner className=\"spin\" /> Λήψη λεπτομερειών...</div>\n                    ) : (\n                        <PromptListForModal\n                            prompts={savedPrompts}\n                            onLoadPrompt={handleLoadPrompt}\n                            isLoading={loadingState.prompts}\n                            currentPromptId={currentPrompt.id}\n                            showError={showError}\n                        />\n                    )}\n                </Modal>\n            )}\n            {showAddMaterialModal && (\n                <Modal title=\"Προσθήκη Πλαισίου από Υλικό\" onClose={() => setShowAddMaterialModal(false)} width=\"700px\" showFooter={true}>\n                    <MaterialListForModal\n                        materials={materials}\n                        onMaterialClick={handleAddMaterialSummary}\n                        isLoading={loadingState.materials}\n                        showError={showError}\n                    />\n                </Modal>\n            )}\n\n            {/* --- ENHANCED QUICK TOUR OVERLAY --- */}\n            {isTutorialActive && guidedSteps[tutorialStep] && (\n                <>\n                    <div className=\"tutorial-overlay-backdrop\" onClick={endTutorial} aria-hidden=\"true\" />\n                    <div\n                        ref={tooltipRef}\n                        className=\"tutorial-tooltip\"\n                        style={{ top: tooltipPos.top, left: tooltipPos.left, position: 'fixed' }}\n                        data-placement={tooltipPos.placement}\n                        role=\"dialog\"\n                        aria-modal=\"true\"\n                        aria-live=\"polite\"\n                    >\n                        <p>{guidedSteps[tutorialStep].content}</p>\n\n                        <div className=\"tutorial-footer\">\n                            <span>Βήμα {tutorialStep + 1} από {guidedSteps.length}</span>\n                            <div className=\"tutorial-buttons\">\n                                {tutorialStep > 0 && (\n                                    <button onClick={prevTutorialStep} className='button subtle-button small' autoFocus>\n                                        Προηγούμενο\n                                    </button>\n                                )}\n                                <button onClick={endTutorial} className='button subtle-button small close-tutorial'>\n                                    Παράλειψη\n                                </button>\n                                <button onClick={nextTutorialStep} className='button primary-button small'>\n                                    {tutorialStep < guidedSteps.length - 1 ? 'Επόμενο' : 'Τέλος'}\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n                </>\n            )}\n        </div>\n    );\n}\n\nexport default PromptWorkshop;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}